# 多语言文档翻译器

一个基于 X.AI API 的多语言文档翻译工具，支持翻译 Word 文档中的段落、表格、文本框和页眉页脚。

## 最新更新 (2024.03.21)

### 性能优化
- 增加了文本批量翻译功能，显著减少 API 请求次数
  - 设置文本缓冲区大小为 1000 字符
  - 设置最小字符数阈值为 300 字符
  - 小于阈值的文本会被自动合并翻译，提高效率
- 添加多 API key 轮换功能
  - 支持配置多个 API key
  - 遇到速率限制时自动切换到下一个 key
  - 无需等待强制冷却时间
  - 提高整体翻译速度

### 表格翻译改进
- 改进表格翻译机制，确保翻译准确性
  - 为每个表格单元格添加唯一标识符 [CELL_行号_列号]
  - 使用标记系统确保翻译内容与原始单元格精确对应
  - 保留表格原有格式和样式
- 优化错误处理机制
  - 单个单元格翻译失败不影响整个表格
  - 添加表格翻译失败的备用显示方案
  - 显示原始内容的行列位置信息

### 进度显示优化
- 优化了可翻译元素的计数方法
  - 只计算非空内容（段落、单元格等）
  - 跳过空白段落和单元格
  - 准确统计文本框和页眉页脚
- 更准确的进度显示
  - 实时显示当前进度和总数
  - 基于实际翻译速度估算剩余时间
  - 支持时分秒格式显示

### 缓存系统改进
- 改进了缓存文件的处理方式
  - 自动创建 .translation_cache 目录
  - 为每个语言版本创建独立缓存
  - 支持断点续传功能
- 缓存管理功能
  - 显示缓存文件数量和大小
  - 提供手动清理缓存选项
  - 自动清理已完成的缓存文件

## API 使用说明
- 基于 X.AI API (grok-beta 模型)
- 支持多 API key 配置
  - 在 .env 文件中配置多个 key
  - 格式：X_AI_API_KEY_1=key1, X_AI_API_KEY_2=key2 等
  - 自动轮换使用多个 key
- API 限制：
  - 每个 key 的请求限制为每小时1200次
  - 遇到限制自动切换到下一个 key
  - 无需等待强制冷却时间
- 批量处理优化：
  - 合并小于300字符的文本
  - 减少 API 调用次数
  - 提高翻译效率

## 支持的语言
- 简体中文
- 繁體中文
- 日本語
- English
- Español
- Français
- Deutsch
- 한국어
- Русский
- Italiano

## 安装要求
